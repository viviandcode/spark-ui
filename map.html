<!DOCTYPE HTML>
<html lang="zh-CN">
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">

		<title>Map - Pixel Spark</title>
		<meta name="keywords" content="key words">
		<meta name="description" content="Pixel Spark">
		<link rel="icon" href="images/favicon.ico" mce_href="images/favicon.ico" type="image/x-icon">

		<link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css" type="text/css"  media="all">
		<link rel="stylesheet" href="https://openlayers.org/en/v3.20.1/css/ol.css" type="text/css">
		<link rel="stylesheet" href="css/style.css" type="text/css"  media="all">

		<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
			<script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->

		<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css" type="text/css"  media="all">
	</head>
	<body>
		<div class="container">
			<nav class="navbar navbar-default" role="navigation" id="nav">
			  <div class="container-fluid">
			    <!-- Brand and toggle get grouped for better mobile display -->
			    <div class="navbar-header">
			      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-menu">
			        <span class="sr-only">Toggle navigation</span>
			        <span class="icon-bar"></span>
			        <span class="icon-bar"></span>
			        <span class="icon-bar"></span>
			      </button>
			      <a class="navbar-brand pixel-font" href="#">Pixel Spark</a>
			    </div>
			    <!-- Collect the nav links, forms, and other content for toggling -->
			    <div class="collapse navbar-collapse" id="main-menu">
			      <ul class="nav navbar-nav navbar-right">
							<li><a href="#"><i class="fa fa-github" aria-hidden="true"></i> Github</a></li>
							<li><a href="#"><i class="fa fa-linkedin" aria-hidden="true"></i> Linkedin</a></li>
			        <li><a href="#"><i class="fa fa-pencil" aria-hidden="true"></i> Blog</a></li>
							<li class="active"><a href="#"><i class="fa fa-map-marker" aria-hidden="true"></i> Mark</a></li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Category <span class="caret"></span></a>
								<ul class="dropdown-menu" role="menu">
									<li><a href="#">Blog</a></li>
									<li class="divider"></li>
									<li><a href="#">膜蛤</a></li>
									<li><a href="#">续一秒</a></li>
									<li class="divider"></li>
									<li><a href="#">Mark</a></li>
									<li><a href="#">Code</a></li>
								</ul>
							</li>
			      </ul>
			    </div><!-- /.navbar-collapse -->
			  </div><!-- /.container-fluid -->
			</nav>

			<div class="row">
				<div class="col-md-2 map-nav-wraper">
					<div class="panel panel-default">
						<div id="map-nav">

								<div class="item clearfix">
									<a class="guider" lng="116.6045142761" lat="27.6883215871" date="2017-02-21" title="title1" local="local1">
										<div class="col-xs-3 icon text-center text-color-ccc">
											<i class="fa fa-map-marker" aria-hidden="true"></i>
										</div>
										<div class="col-xs-9">
											<span class="text-color-333">Chongqing1</span>
											<time class="text-color-ccc text-nowrap">Jan. 21st 2017</time>
										</div>
									</a>
								</div>

								<div class="item clearfix">
									<a class="guider" lng="106.6045142761" lat="29.6883215871" date="2017-02-21" title="title2" local="local2">
										<div class="col-xs-3 icon text-center text-color-ccc">
											<i class="fa fa-map-marker" aria-hidden="true"></i>
										</div>
										<div class="col-xs-9">
											<span class="text-color-333">Shenmegui2</span>
											<time class="text-color-ccc text-nowrap">Mar. 21st 2017</time>
										</div>
									</a>
								</div>

								<div class="item clearfix">
									<a class="guider" lng="107.2045142761" lat="29.6883215871" date="2017-02-21" title="title3" local="local3">
										<div class="col-xs-3 icon text-center text-color-ccc">
											<i class="fa fa-map-marker" aria-hidden="true"></i>
										</div>
										<div class="col-xs-9">
											<span class="text-color-333">Chongqing3</span>
											<time class="text-color-ccc text-nowrap">Mar. 21st 2017</time>
										</div>
									</a>
								</div>

						</div>
					</div>
				</div>

				<div class="col-md-10">
					<div class="panel panel-default">
						<div id="map"><div id="popup"></div></div>
					</div>
				</div>
			</div>

		</div>
		<script src="http://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
		<script src="http://cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
		<script src="https://openlayers.org/en/v3.20.1/build/ol.js" type="text/javascript"></script>
		<script>
      var rome = new ol.Feature({
        geometry: new ol.geom.Point(ol.proj.fromLonLat([12.5, 41.9])),
				id: 1,
        html: 'Null Island <a href="http://baidu.com/">link</a>',
      });

			var iconFeature2 = new ol.Feature({
				geometry: new ol.geom.Point(ol.proj.fromLonLat([13.8, 41.9])),
				id: 2,
				html: 'Null22',
			});

      var iconStyle = new ol.style.Style({
        image: new ol.style.Icon(/** @type {olx.style.IconOptions} */ ({
          anchor: [0.5, 46],
          anchorXUnits: 'fraction',
          anchorYUnits: 'pixels',
          src: 'https://openlayers.org/en/v3.20.1/examples/data/icon.png'
        }))
      });

			rome.setStyle(iconStyle);
      iconFeature2.setStyle(iconStyle);

      var vectorSource = new ol.source.Vector({
        features: [rome, iconFeature2]
      });

      var vectorLayer = new ol.layer.Vector({
        source: vectorSource
      });

      var rasterLayer = new ol.layer.Tile({
        source: new ol.source.TileJSON({
          url: 'https://api.tiles.mapbox.com/v3/mapbox.geography-class.json?secure',
          crossOrigin: ''
        })
      });

			var simpleLayer = new ol.layer.Tile({
				 source: new ol.source.OSM()
			 })

      var map = new ol.Map({
				layers: [simpleLayer, vectorLayer],
        target: document.getElementById('map'),
        view: new ol.View({
          center: ol.proj.fromLonLat([12.5, 41.9]),
          zoom: 5
        })
      });

      var element = document.getElementById('popup');

      var popup = new ol.Overlay({
        element: element,
        positioning: 'bottom-center',
        stopEvent: false,
        offset: [0, -50]
      });
      map.addOverlay(popup);

      // display popup on click
      map.on('click', function(evt) {
        var feature = map.forEachFeatureAtPixel(evt.pixel,
        function(feature) {
          return feature;
        });

        if (feature) {
          var coordinates = feature.getGeometry().getCoordinates();
          popup.setPosition(coordinates);
          $(element).popover({
            'placement': 'top',
            'html': true,
            'content': feature.get('html')
          });
          $(element).popover('show');
        } else {
          $(element).popover('destroy');
        }
      });

      // change mouse cursor when over marker
      map.on('pointermove', function(e) {
				/*
        if (e.dragging) {
          $(element).popover('destroy');
          return;
        }
				*/
        var pixel = map.getEventPixel(e.originalEvent);
        var hit = map.hasFeatureAtPixel(pixel);
        map.getTarget().style.cursor = hit ? 'pointer' : '';
      });
    </script>
	</body>
</html>
